<div class="movie-hub-container">
  <sh-search-bar (search)="onSearch($event)"></sh-search-bar>

  <h2 class="section-title">
    {{ (currentQuery$ | async) ? 'Search results' : 'Popular movies' }}
  </h2>

  @if (loading$ | async) {
    <div class="loading-container">
      <mat-spinner diameter="100"></mat-spinner>
    </div>
  } @else {
    @if (favoriteIds$ | async; as favoriteIds) {
      <div class="movies-grid">
        @if (movies$ | async; as movies) {
          @for (movie of movies; track movie.id) {
            <sh-movie-card
              [movie]="movie"
              [isFavorite]="isMovieFavorite(movie.id, favoriteIds)"
              (toggleFavorite)="onToggleFavorite(movie.id, isMovieFavorite(movie.id, favoriteIds))"
            ></sh-movie-card>
          } @empty {
            <div class="no-results">No movies found. Try a different search query.</div>
          }
        }
      </div>
    }
    @if ((totalPages$ | async)! > 1) {
      <sh-pagination
        [currentPage]="(currentPage$ | async) ?? 1"
        [totalPages]="(totalPages$ | async) ?? 1"
        (pageChange)="onPageChange($event)"
      >
      </sh-pagination>
    }
  }
</div>
